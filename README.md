# Wallet control
Проект на базе Spring boot для учета расходов и доходов.
Приложение предоставляет возможности для регистрации пользователей, аутентификации с использованием JWT, а также управления финансовыми операциями.  
Проект находится в разработке и будет добавляться новая функциональность.

---

## Технологии
* Spring Boot
* Spring Security
* Spring Data JPA
* Spring Email
* Spring Validation
* Hibernate
* PostgreSQL

---

## Установка
1. Клонирование репозитория  
```git clone https://github.com/KaznacheevPavel/wallet-control.git```
2. Переименуйте ```.env.origin``` в ```.env``` и заполните своими параметрами.
3. Соберите проект с помощью Maven  
```mvn clean package```
4. Запустите приложение в Docker  
```docker compose up --build```

---

## Использование

### Валидация
Все запросы валидируются и пользователю возвращается в ответе понятное сообщение об ошибке.  
Например, ответ при регистрации пользователя с неверными данными:
```json
{
    "title": "VALIDATION_ERROR",
    "status": 400,
    "detail": "Ошибка валидации",
    "data": {
        "password": [
            "Пароль должен иметь хотя бы одну заглавную английскую букву",
            "Пароль должен иметь хотя бы одну цифру",
            "Пароль должен иметь хотя бы один специальный символ из #?!@$%^&*_-"
        ],
        "email": [
            "Неверный формат email"
        ],
        "username": [
            "Имя пользователя должно быть не меньше 6 символов"
        ]
    }
}
```

### Регистрация пользователя
Отправьте POST запрос на ```/api/users```
```json
{
  "username" : "exampleUsername",
  "email" : "example@email.com",
  "password" : "SecretPa$$2"
}
```
После этого на указанный адрес электронной почты будет отправлено письмо с ссылкой для подтверждения.
Ссылка действительна в течении 24 часов, после аккаунт будет удален автоматически

### Подтверждение электронной почты
Перейдите по ссылке в письме для подтверждения почты и активации аккаунта.  
Пример ссылки:  
```http://localhost:8080/api/tokens?token=761bfa0c-6782-49c4-8f99-3024831f3d48```

### Аутентификация
Отправьте POST запрос на ```/api/login```
```json
{
    "username" : "exampleUsername",
    "password" : "SecretPa$$2"
}
```
В ответ вы получите JWT, который нужно будет использовать для доступа к защищенным ресурсам.  

### Доступ к защищенным ресурсам
Для доступа к защищенным ресурсам ваш аккаунт должен быть активирован и к каждому запросу
должен передаваться JWT в ```Authorization``` заголовке с припиской ```Bearer```

### Получение списка доступных категорий операций 
Отправьте GET запрос на ```/api/categories``` с JWT для получения списка категорий.
Пример ответа:
```json
{
    "title": "SUCCESS",
    "status": 200,
    "detail": "Список доступных категорий",
    "data": {
        "categories": [
            "Авто",
            "Продукты",
            "Коммунальные услуги",
            "Одежда",
            "Транспорт",
            "Косметика",
            "Аренда",
            "Прочее"
        ]
    }
}
```

### Добавление операции
Отправьте POST запрос на ```/api/operations``` с JWT для добавления операции.
```json
{
    "category" : "Авто",
    "type" : "EXPENSE",
    "amount" : 1672.99,
    "description" : "Покупка омывателя"
}
```
```category``` - категория операции.  
```type``` - тип операции (```INCOME / EXPENSE```).

### Получение списка операций
Отправьте GET запрос на ```/api/operations?timeZone=Europe/Moscow``` с JWT для получения списка операций с московским временем.  
Параметр ```timeZone``` указывает на часовой пояс пользователя, например ```Europe/Moscow```  
Пример ответа:
```json
{
    "title": "SUCCESS",
    "status": 200,
    "detail": "Список операций",
    "data": {
        "operations": [
            {
                "created_at": "10-03-2025 12:40:15",
                "category": "Авто",
                "type": "EXPENSE",
                "amount": 1672.99,
                "description": "Покупка омывателя"
            },
            {
                "created_at": "10-03-2025 12:41:15",
                "category": "Продукты",
                "type": "EXPENSE",
                "amount": 2394.00,
                "description": ""
            }
        ]
    }
}
```